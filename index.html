<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#0c0a14" />
  <meta name="description" content="Ê≥ïËØ≠ÁªÉ‰π† ¬∑ TCF Â°´Á©∫„ÄÅÊÆµËêΩÂ°´Á©∫„ÄÅÂçïÈÄâ„ÄÅÂ§öÈÄâÔºåÊîØÊåÅÈîôÈ¢òÊú¨‰∏é‰π†È¢òÈõÜÁÆ°ÁêÜ" />
  <title>Fran√ßais Quiz ¬∑ Ê≥ïËØ≠ÁªÉ‰π†</title>
  <link rel="icon" href="favicon.svg?v=2" type="image/svg+xml" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Noto+Sans+SC:wght@400;500;600;700&display=swap" as="style" />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Noto+Sans+SC:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #0c0a14;
      --card: #16141f;
      --surface: #1e1b28;
      --accent: #8b5cf6;
      --accent-hover: #a78bfa;
      --accent-soft: rgba(139, 92, 246, 0.15);
      --correct: #34d399;
      --wrong: #f87171;
      --option-a: #60a5fa;
      --option-b: #fbbf24;
      --option-c: #4ade80;
      --option-d: #fb923c;
      --text: #f5f3ff;
      --text-muted: #a1a1aa;
      --radius: 16px;
      --radius-sm: 10px;
      --shadow: 0 4px 24px rgba(0,0,0,0.25);
      --shadow-sm: 0 2px 8px rgba(0,0,0,0.15);
      --shadow-lg: 0 8px 32px rgba(0,0,0,0.35);
      --border-subtle: rgba(255,255,255,0.06);
      --border-subtle-hover: rgba(255,255,255,0.08);
      --border-strong: rgba(255,255,255,0.1);
    }
    body.theme-light {
      --bg: #f8f7fc;
      --card: #fff;
      --surface: #f0eef8;
      --text: #1c1917;
      --text-muted: #78716c;
      --shadow: 0 4px 20px rgba(124, 58, 237, 0.08);
      --shadow-sm: 0 2px 8px rgba(0,0,0,0.06);
      --shadow-lg: 0 8px 32px rgba(0,0,0,0.12);
      --border-subtle: rgba(0,0,0,0.06);
      --border-subtle-hover: rgba(0,0,0,0.08);
      --border-strong: rgba(0,0,0,0.1);
      background: var(--bg);
      background-image: none;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    *:focus { outline: none; }
    *:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    html { overflow-x: hidden; }
    body {
      overflow-x: hidden;
      font-family: 'Plus Jakarta Sans', 'Noto Sans SC', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      background-image:
        radial-gradient(ellipse 100% 60% at 50% -15%, rgba(139, 92, 246, 0.2), transparent 50%),
        radial-gradient(ellipse 70% 50% at 100% 80%, rgba(96, 165, 250, 0.12), transparent),
        radial-gradient(ellipse 50% 30% at 0% 60%, rgba(139, 92, 246, 0.08), transparent);
      transition: background 0.3s, color 0.3s;
    }

    .container {
      width: 100%;
      max-width: 640px;
      margin: 0 auto;
      padding: 1.5rem 1.25rem;
      padding-left: max(1.25rem, env(safe-area-inset-left));
      padding-right: max(1.25rem, env(safe-area-inset-right));
      padding-top: max(1.5rem, env(safe-area-inset-top));
      padding-bottom: max(1.25rem, env(safe-area-inset-bottom));
    }
    @media (min-width: 600px) {
      .container { padding: 2rem 1.5rem; }
    }
    @media (max-width: 380px) {
      .container { padding: 1rem 0.75rem; }
      header h1 { font-size: 1.35rem; }
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 1.75rem;
      padding-bottom: 1.25rem;
      border-bottom: 1px solid var(--border-subtle);
    }
    body.theme-light header { border-bottom-color: var(--border-subtle); }
    header .brand {
      text-align: left;
    }
    header h1 {
      font-size: 1.75rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      background: linear-gradient(135deg, #c4b5fd 0%, #a78bfa 50%, #818cf8 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    header p {
      color: var(--text-muted);
      font-size: 0.875rem;
      font-weight: 500;
      margin-top: 0.2rem;
    }
    .theme-toggle {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-strong);
      background: var(--surface);
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      transition: all 0.2s;
    }
    .theme-toggle:hover { border-color: var(--accent); color: var(--accent); background: var(--accent-soft); }
    body.theme-light .theme-toggle { border-color: var(--border-subtle-hover); background: var(--surface); }
    body.theme-light .question-card,
    body.theme-light .result-card { box-shadow: var(--shadow-sm); }
    body.theme-light .option { border-color: var(--border-subtle-hover); }
    body.theme-light .option:hover { background: rgba(0,0,0,0.04); }

    .stats-bar {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
    }
    .stats-bar span {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.6rem 1rem;
      background: var(--surface);
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-subtle);
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--text-muted);
    }
    body.theme-light .stats-bar span { border-color: var(--border-subtle); background: var(--card); }
    .stats-bar strong {
      color: var(--accent);
      font-weight: 700;
      margin-right: 0.15rem;
    }

    .home-section {
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border-subtle);
      padding: 1.5rem;
      margin-bottom: 1.25rem;
      box-shadow: var(--shadow-sm);
      transition: box-shadow 0.2s, border-color 0.2s;
    }
    .home-section:hover {
      border-color: var(--border-subtle-hover);
      box-shadow: var(--shadow);
    }
    body.theme-light .home-section { border-color: var(--border-subtle); }
    body.theme-light .home-section:hover { border-color: rgba(124, 58, 237, 0.2); box-shadow: var(--shadow); }
    .home-section h2 {
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 0.85rem;
    }

    .screen {
      display: none;
    }
    .screen.active {
      display: block;
      animation: fadeIn 0.35s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    #screen-result.active {
      animation: fadeIn 0.4s ease;
    }
    #screen-result .result-card {
      animation: fadeIn 0.5s ease 0.1s both;
    }

    /* Question transitions */
    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes slideOutLeft {
      from { opacity: 1; transform: translateX(0); }
      to { opacity: 0; transform: translateX(-30px); }
    }
    .question-card.animate-in { animation: slideInRight 0.3s ease forwards; }
    .question-card.animate-out { animation: slideOutLeft 0.2s ease forwards; }

    /* Answer feedback animations */
    @keyframes bounceIn {
      0% { transform: scale(0.8); opacity: 0; }
      60% { transform: scale(1.05); }
      100% { transform: scale(1); opacity: 1; }
    }
    @keyframes shakeX {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-6px); }
      40%, 80% { transform: translateX(6px); }
    }
    .answer-feedback.correct-msg { animation: bounceIn 0.4s ease; }
    .answer-feedback.wrong-msg { animation: shakeX 0.4s ease; }

    /* Option click effect */
    @keyframes optionPulse {
      0% { transform: scale(1); }
      50% { transform: scale(0.97); }
      100% { transform: scale(1); }
    }
    .option.just-selected { animation: optionPulse 0.2s ease; }

    /* Stats bar number pop */
    @keyframes countPop {
      0% { transform: scale(1); }
      50% { transform: scale(1.25); color: var(--accent-hover); }
      100% { transform: scale(1); }
    }
    .stats-bar strong { display: inline-block; }
    .stats-bar strong.updated { animation: countPop 0.3s ease; }

    /* Circular timer ring */
    .timer-ring { flex-shrink: 0; }
    .timer-ring-fill { transition: stroke-dashoffset 1s linear, stroke 0.3s; }
    .timer-ring-fill.low { stroke: var(--wrong); }

    .home-actions {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    .home-actions .btn { min-height: 52px; }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.95rem 1.5rem;
      min-height: 48px;
      font-size: 1rem;
      font-weight: 600;
      font-family: inherit;
      border: none;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 28px rgba(139, 92, 246, 0.35);
    }
    .btn:active { transform: translateY(0); }
    .btn-primary {
      background: linear-gradient(135deg, var(--accent) 0%, #6366f1 100%);
      color: white;
      box-shadow: 0 4px 14px rgba(139, 92, 246, 0.4);
    }
    .btn-primary:hover { box-shadow: 0 10px 32px rgba(139, 92, 246, 0.45); }
    .btn-secondary {
      background: var(--surface);
      color: var(--text);
      border: 1px solid var(--border-strong);
    }
    .btn-secondary:hover {
      border-color: var(--accent);
      background: var(--accent-soft);
      box-shadow: 0 8px 24px rgba(139, 92, 246, 0.2);
    }
    body.theme-light .btn-secondary { background: var(--card); border-color: var(--border-strong); }
    body.theme-light .btn-secondary:hover { background: var(--surface); border-color: var(--accent); }

    .import-section {
      margin-top: 2rem;
      padding: 1.5rem;
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-sm);
    }
    body.theme-light .import-section { border-color: var(--border-subtle); }
    .import-section h3 {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-muted);
      margin-bottom: 0.75rem;
    }
    .import-section textarea {
      width: 100%;
      min-height: 140px;
      padding: 0.85rem;
      font-family: inherit;
      font-size: 0.9rem;
      background: var(--surface);
      border: 1px solid var(--border-subtle-hover);
      border-radius: var(--radius-sm);
      color: var(--text);
      resize: vertical;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    .import-section textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-soft);
    }
    body.theme-light .import-section textarea { background: var(--bg); border-color: var(--border-strong); }
    .import-section textarea::placeholder {
      color: var(--text-muted);
    }
    .import-section .hint {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
    }

    /* Quiz */
    .progress-wrap {
      margin-bottom: 1.25rem;
    }
    .progress-label {
      display: block;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
    }
    .progress-estimate {
      display: block;
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 0.35rem;
    }
    .progress-bar {
      height: 8px;
      background: var(--surface);
      border-radius: 999px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.04);
    }
    body.theme-light .progress-bar { border-color: var(--border-subtle); }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), #818cf8);
      border-radius: 999px;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 12px rgba(139, 92, 246, 0.5);
    }

    .question-card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 1.75rem;
      border: 1px solid var(--border-subtle);
      margin-bottom: 1.5rem;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    .question-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: linear-gradient(180deg, var(--accent), #818cf8);
      border-radius: 4px 0 0 4px;
    }
    body.theme-light .question-card::before { opacity: 0.9; }
    .question-meta {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 0.5rem;
      letter-spacing: 0.03em;
    }
    .question-stem {
      font-size: 1.25rem;
      line-height: 1.65;
      margin-bottom: 1.25rem;
      font-weight: 500;
      letter-spacing: 0.01em;
    }
    @media (min-width: 480px) {
      .question-stem { font-size: 1.35rem; }
    }
    .question-stem .blank {
      display: inline-block;
      min-width: 120px;
      border-bottom: 2px solid var(--accent);
      margin: 0 4px;
      padding: 0 4px;
    }
    .question-stem .blank.filled {
      border-color: var(--correct);
      color: var(--correct);
    }
    .question-stem .blank.wrong {
      border-color: var(--wrong);
      color: var(--wrong);
    }
    .paragraph-blanks {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .paragraph-blanks input {
      width: 120px;
      padding: 0.5rem 0.75rem;
      font-size: 1rem;
      background: var(--surface);
      border: 2px solid rgba(255,255,255,0.1);
      border-radius: var(--radius-sm);
      color: var(--text);
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    body.theme-light .paragraph-blanks input { background: var(--card); border-color: rgba(0,0,0,0.12); }
    .paragraph-blanks input:focus {
      outline: none;
      border-color: var(--accent);
    }
    .paragraph-blanks input.correct-blank {
      border-color: var(--correct);
      background: rgba(16, 185, 129, 0.15);
    }
    .paragraph-blanks input.wrong-blank {
      border-color: var(--wrong);
      background: rgba(239, 68, 68, 0.15);
    }

    .options {
      display: grid;
      contain: layout;
      grid-template-columns: 1fr 1fr;
      gap: 0.85rem;
    }
    @media (max-width: 480px) {
      .options { grid-template-columns: 1fr; }
      .question-card { padding: 1.25rem; }
      .question-stem { font-size: 1rem; word-break: break-word; }
      .option { padding: 0.85rem 1rem; min-height: 44px; }
      .quiz-actions .btn { min-width: 100px; }
    }
    @media (max-width: 360px) {
      .question-card { padding: 1rem; }
      .option-letter { width: 28px; height: 28px; font-size: 0.8rem; }
    }
    .option {
      display: flex;
      align-items: center;
      gap: 0.85rem;
      padding: 1rem 1.25rem;
      min-height: 48px;
      background: var(--surface);
      border: 2px solid rgba(255,255,255,0.06);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.2s;
    }
    .option:hover {
      background: rgba(255,255,255,0.06);
      border-color: rgba(255,255,255,0.12);
      transform: translateY(-1px);
    }
    .option.selected {
      border-color: var(--accent);
      background: var(--accent-soft);
      box-shadow: 0 0 0 1px var(--accent);
    }
    .option.correct {
      border-color: var(--correct);
      background: rgba(52, 211, 153, 0.12);
    }
    .option.wrong {
      border-color: var(--wrong);
      background: rgba(248, 113, 113, 0.12);
    }
    .option.disabled {
      pointer-events: none;
      opacity: 0.65;
    }
    .option-letter {
      width: 34px;
      height: 34px;
      flex-shrink: 0;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.9rem;
    }
    .option:nth-child(1) .option-letter { background: var(--option-a); color: #fff; }
    .option:nth-child(2) .option-letter { background: var(--option-b); color: #1a1a1a; }
    .option:nth-child(3) .option-letter { background: var(--option-c); color: #fff; }
    .option:nth-child(4) .option-letter { background: var(--option-d); color: #fff; }
    .option input {
      margin: 0;
      accent-color: var(--accent);
    }
    .option-label {
      flex: 1;
    }

    .fill-input-wrap {
      margin-top: 0.5rem;
    }
    .fill-input-wrap input {
      width: 100%;
      max-width: 280px;
      padding: 0.75rem 1rem;
      font-size: 1rem;
      font-family: inherit;
      background: var(--surface);
      border: 2px solid rgba(255,255,255,0.1);
      border-radius: var(--radius-sm);
      color: var(--text);
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    .fill-input-wrap input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-soft);
    }
    body.theme-light .fill-input-wrap input { background: var(--card); border-color: rgba(0,0,0,0.12); }

    .answer-feedback {
      margin-top: 1rem;
      padding: 0.65rem 1rem;
      border-radius: var(--radius-sm);
      font-weight: 600;
      font-size: 1rem;
      display: none;
    }
    .answer-feedback.correct-msg { background: rgba(52, 211, 153, 0.15); color: var(--correct); display: block; border: 1px solid rgba(52, 211, 153, 0.3); }
    .answer-feedback.wrong-msg { background: rgba(248, 113, 113, 0.15); color: var(--wrong); display: block; border: 1px solid rgba(248, 113, 113, 0.3); }
    .explanation {
      margin-top: 1.25rem;
      padding: 1rem 1.15rem;
      background: rgba(52, 211, 153, 0.08);
      border: 1px solid rgba(52, 211, 153, 0.25);
      border-radius: var(--radius-sm);
      font-size: 0.9rem;
      line-height: 1.65;
      color: #6ee7b7;
      white-space: pre-wrap;
    }
    body.theme-light .explanation { background: rgba(52, 211, 153, 0.1); color: #059669; border-color: rgba(52, 211, 153, 0.3); }
    .wrong-book-remove-wrap { margin-top: 0.75rem; }
    .remove-from-set-wrap { margin-top: 0.5rem; }
    .btn-sm { padding: 0.4rem 0.75rem; font-size: 0.85rem; min-height: auto; }

    .quiz-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 1.5rem;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .quiz-actions-right {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .quiz-actions .btn {
      min-width: 120px;
    }
    .quiz-actions #btn-exit-quiz { min-width: auto; }
    .quiz-shortcut-hint {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
      width: 100%;
    }

    .timer-wrap {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    .timer-wrap label { font-size: 0.9rem; color: var(--text-muted); }
    .timer-wrap input[type="number"] {
      width: 4rem;
      padding: 0.45rem 0.5rem;
      font-size: 0.9rem;
      background: var(--surface);
      border: 1px solid var(--border-strong);
      border-radius: var(--radius-sm);
      color: var(--text);
    }
    body.theme-light .timer-wrap input[type="number"] { background: var(--card); border-color: rgba(0,0,0,0.12); }
    .shuffle-wrap { display: flex; align-items: center; gap: 0.4rem; }
    .shuffle-wrap input[type="checkbox"] { accent-color: var(--accent); cursor: pointer; }
    .shuffle-wrap label { font-size: 0.85rem; color: var(--text-muted); cursor: pointer; }
    .type-filter-wrap { margin-top: 0.75rem; }
    .type-filter-wrap .type-filter-label { display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.4rem; }
    .type-filter-row { display: flex; flex-wrap: wrap; gap: 0.75rem 1.25rem; align-items: center; }
    .type-filter-row label { display: flex; align-items: center; gap: 0.35rem; font-size: 0.9rem; color: var(--text); cursor: pointer; }
    .type-filter-row input[type="checkbox"] { accent-color: var(--accent); cursor: pointer; }
    .start-select-wrap { margin-bottom: 0.75rem; }
    .category-filter-wrap { margin-bottom: 0.75rem; }
    .category-filter-wrap label { display: block; font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.35rem; }
    .category-filter-wrap select {
      width: 100%;
      max-width: 320px;
      padding: 0.65rem 0.85rem;
      font-size: 0.95rem;
      font-family: inherit;
      background: var(--surface);
      border: 1px solid var(--border-strong);
      border-radius: var(--radius-sm);
      color: var(--text);
      cursor: pointer;
    }
    body.theme-light .category-filter-wrap select { background: var(--card); border-color: rgba(0,0,0,0.12); }
    .start-select-wrap label { display: block; font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.35rem; }
    .start-select-wrap select {
      width: 100%;
      max-width: 320px;
      padding: 0.65rem 0.85rem;
      font-size: 0.95rem;
      font-family: inherit;
      background: var(--surface);
      border: 1px solid var(--border-strong);
      border-radius: var(--radius-sm);
      color: var(--text);
      cursor: pointer;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    .start-select-wrap select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px var(--accent-soft);
    }
    body.theme-light .start-select-wrap select { background: var(--card); border-color: rgba(0,0,0,0.12); }
    .quiz-timer {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent);
      min-width: 2.5rem;
    }
    .quiz-timer.low { color: var(--wrong); }
    .question-stem-wrap { position: relative; }
    .btn-read-aloud {
      margin-top: 0.5rem;
      padding: 0.4rem 0.85rem;
      font-size: 0.85rem;
      font-weight: 500;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-strong);
      background: var(--surface);
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-read-aloud:hover { border-color: var(--accent); color: var(--accent); background: var(--accent-soft); }
    body.theme-light .btn-read-aloud { background: var(--card); border-color: var(--border-strong); }
    .result-celebration {
      font-size: 1.35rem;
      margin-top: 0.75rem;
      color: var(--correct);
      font-weight: 700;
      animation: pulse 1.5s ease-in-out infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.9; transform: scale(1.02); }
    }
    .saved-sets-search { margin-bottom: 1rem; }
    .saved-sets-search input {
      width: 100%;
      padding: 0.65rem 1rem 0.65rem 2.25rem;
      font-size: 0.9rem;
      background: var(--bg);
      border: 1px solid var(--border-strong);
      border-radius: 10px;
      color: var(--text);
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    .saved-sets-search input::placeholder { color: var(--text-muted); }
    .saved-sets-search input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-soft);
    }
    .saved-sets-search-wrap { position: relative; }
    .saved-sets-search-wrap::before {
      content: 'üîç';
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.9rem;
      opacity: 0.6;
      pointer-events: none;
    }
    body.theme-light .saved-sets-search input { border-color: rgba(0,0,0,0.12); }

    /* Result */
    .result-card {
      text-align: center;
      padding: 2.5rem 2rem;
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow);
      position: relative;
      overflow: visible;
    }
    .result-card .result-confetti { border-radius: var(--radius); }
    .result-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent), #818cf8);
    }
    .result-score {
      font-size: 3.25rem;
      font-weight: 800;
      letter-spacing: -0.03em;
      background: linear-gradient(135deg, #c4b5fd, #a78bfa 40%, #818cf8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.5rem;
      line-height: 1.1;
    }
    .result-pct {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent);
      margin: -0.25rem 0 0.5rem;
    }
    .result-desc {
      color: var(--text-muted);
      font-size: 1.05rem;
      font-weight: 500;
      margin-bottom: 1.5rem;
    }
    .result-confetti {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      border-radius: inherit;
    }
    .result-confetti span {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      animation: confetti 2.5s ease-out forwards;
      opacity: 0;
    }
    @keyframes confetti {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(-120px) rotate(720deg); opacity: 0; }
    }
    .result-card .btn {
      margin-top: 0.5rem;
    }
    .result-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: center;
      margin-top: 1.25rem;
    }
    .result-shortcut-hint {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin: 0.75rem 0 0;
      text-align: center;
    }
    .wrong-book-btn { background: rgba(248, 113, 113, 0.15); color: #fca5a5; border: 1px solid rgba(248, 113, 113, 0.35); }
    .wrong-book-btn:hover { background: rgba(248, 113, 113, 0.25); box-shadow: 0 4px 16px rgba(248, 113, 113, 0.2); }
    .result-recent {
      margin-top: 1.5rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(255,255,255,0.06);
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    body.theme-light .result-recent { border-top-color: var(--border-subtle); }
    .result-recent-title { font-weight: 600; margin-bottom: 0.35rem; }
    .result-recent ul { list-style: none; }
    .result-recent li { padding: 0.2rem 0; }

    .format-doc {
      margin-top: 1.5rem;
      padding: 1.25rem;
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border-subtle);
    }
    body.theme-light .format-doc { border-color: var(--border-subtle); }
    .format-doc-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.75rem;
      cursor: pointer;
      user-select: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .format-doc-title::before { content: '‚ñ∂'; font-size: 0.7rem; transition: transform 0.2s; }
    .format-doc.open .format-doc-title::before { transform: rotate(90deg); }
    .format-doc-content { display: none; font-size: 0.8rem; line-height: 1.7; color: var(--text-muted); max-height: 320px; overflow-y: auto; overflow-x: hidden; }
    .format-doc.open .format-doc-content { display: block; }
    .format-doc pre {
      background: var(--bg);
      padding: 0.75rem;
      border-radius: 8px;
      overflow-x: auto;
      margin: 0.5rem 0;
      font-size: 0.75rem;
      white-space: pre-wrap;
      word-break: break-all;
    }
    .format-doc .type-tag { color: var(--accent); font-weight: 600; }

    .saved-sets {
      margin-top: 1.5rem;
      padding: 1.5rem;
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-sm);
    }
    body.theme-light .saved-sets { border-color: var(--border-subtle); }
    .saved-sets h3 {
      font-size: 0.9rem;
      font-weight: 700;
      color: var(--text-muted);
      letter-spacing: 0.03em;
      margin-bottom: 0.85rem;
    }
    .saved-sets-folders-bar { display: flex; align-items: center; flex-wrap: wrap; gap: 0.5rem 0.75rem; margin-bottom: 0.75rem; }
    .saved-sets-folders-label { font-size: 0.85rem; color: var(--text-muted); }
    .saved-sets-folder-tags { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .folder-tag { display: inline-flex; align-items: center; gap: 0.4rem; padding: 0.4rem 0.65rem; background: var(--surface); border: 1px solid var(--border-strong); border-radius: 6px; font-size: 0.85rem; color: var(--text); box-shadow: 0 1px 2px rgba(0,0,0,0.15); }
    .folder-tag .folder-tag-icon { width: 16px; height: 16px; flex-shrink: 0; opacity: 0.9; }
    .folder-tag .folder-tag-icon svg { width: 100%; height: 100%; fill: var(--accent); }
    .folder-tag .folder-tag-name { max-width: 120px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .folder-tag .folder-tag-edit, .folder-tag .folder-tag-delete { min-width: 44px; min-height: 44px; padding: 0 0.35rem; font-size: 0.9rem; line-height: 1; background: none; border: none; color: var(--text-muted); cursor: pointer; border-radius: 4px; display: inline-flex; align-items: center; justify-content: center; }
    .folder-tag .folder-tag-edit:hover, .folder-tag .folder-tag-delete:hover { color: var(--text); }
    .folder-tag .folder-tag-delete:hover { color: #f87171; }
    body.theme-light .folder-tag { border-color: var(--border-strong); box-shadow: 0 1px 2px rgba(0,0,0,0.06); }
    .saved-sets-folder { margin-bottom: 0.75rem; border-radius: var(--radius-sm); border: 1px solid var(--border-subtle-hover); background: var(--surface); overflow: hidden; }
    .saved-sets-folder:last-child { margin-bottom: 0; }
    body.theme-light .saved-sets-folder { border-color: var(--border-subtle-hover); background: var(--bg); }
    .saved-sets-folder-header { display: flex; align-items: center; gap: 0.25rem; width: 100%; padding: 0; background: rgba(139, 92, 246, 0.08); color: var(--text); }
    .saved-sets-folder-header:hover { background: rgba(139, 92, 246, 0.14); }
    body.theme-light .saved-sets-folder-header { background: rgba(139, 92, 246, 0.06); }
    body.theme-light .saved-sets-folder-header:hover { background: rgba(139, 92, 246, 0.12); }
    .saved-sets-folder-toggle { display: flex; align-items: center; gap: 0.5rem; flex: 1; min-width: 0; padding: 0.6rem 0.85rem; border: none; background: none; color: inherit; font-size: 0.9rem; font-weight: 600; text-align: left; cursor: pointer; }
    .saved-sets-folder-header .folder-icon-wrap { width: 20px; height: 20px; flex-shrink: 0; }
    .saved-sets-folder-header .folder-icon-wrap svg { width: 100%; height: 100%; fill: var(--accent); }
    .saved-sets-folder-header .saved-sets-folder-name { flex: 1; min-width: 0; }
    .saved-sets-folder-header .folder-chevron { font-size: 0.7rem; opacity: 0.8; transition: transform 0.2s; flex-shrink: 0; }
    .saved-sets-folder-collapsed .saved-sets-folder-header .folder-chevron { transform: rotate(-90deg); }
    .saved-sets-folder-header .folder-header-edit, .saved-sets-folder-header .folder-header-delete { min-width: 44px; min-height: 44px; padding: 0 0.5rem; margin-right: 0.25rem; font-size: 0.85rem; background: none; border: none; color: var(--text-muted); cursor: pointer; border-radius: 4px; flex-shrink: 0; display: inline-flex; align-items: center; justify-content: center; }
    .saved-sets-folder-header .folder-header-edit:hover, .saved-sets-folder-header .folder-header-delete:hover { color: var(--text); }
    .saved-sets-folder-header .folder-header-delete:hover { color: #f87171; }
    .saved-sets-folder-body { border-top: 1px solid rgba(255,255,255,0.06); }
    body.theme-light .saved-sets-folder-body { border-top-color: var(--border-subtle); }
    .saved-sets-folder-collapsed .saved-sets-folder-body { display: none; }
    .saved-sets-folder-body .saved-sets-list { padding: 0.5rem 0.75rem 0.75rem; gap: 0.5rem; }
    .saved-sets-folder-body .saved-sets-item { margin: 0; }
    .saved-sets-show-more-wrap { margin-top: 0.75rem; text-align: center; }
    .saved-sets-show-more { min-width: 160px; }
    .saved-sets-list-wrap {
      max-height: 320px;
      overflow-y: auto;
      overflow-x: hidden;
      margin: 0 -0.25rem 0 0;
      padding-right: 0.25rem;
    }
    .saved-sets-list-wrap::-webkit-scrollbar { width: 6px; }
    .saved-sets-list-wrap::-webkit-scrollbar-track { background: transparent; border-radius: 3px; }
    .saved-sets-list-wrap::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
    body.theme-light .saved-sets-list-wrap::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.2); }
    .saved-sets-list { list-style: none; display: flex; flex-direction: column; gap: 0.65rem; contain: layout; }
    .saved-sets-item {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 1rem;
      padding: 1rem 1.15rem;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-subtle);
      background: var(--surface);
      flex-wrap: wrap;
      transition: all 0.2s;
    }
    .saved-sets-item:hover {
      border-color: rgba(139, 92, 246, 0.35);
      background: var(--accent-soft);
      box-shadow: var(--shadow-sm);
    }
    body.theme-light .saved-sets-item { border-color: var(--border-subtle-hover); background: var(--bg); }
    body.theme-light .saved-sets-item:hover { border-color: var(--accent); background: var(--surface); }
    .saved-sets-item-content { flex: 1; min-width: 0; }
    .saved-sets-item .name {
      display: block;
      font-weight: 600;
      font-size: 1rem;
      color: var(--text);
      margin-bottom: 0.35rem;
      line-height: 1.4;
    }
    .saved-sets-item .meta {
      font-size: 0.8rem;
      color: var(--text-muted);
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.35rem;
    }
    .saved-sets-item .meta span { white-space: nowrap; }
    .saved-sets-item .meta .dot { opacity: 0.5; user-select: none; }
    .saved-sets-item .actions { display: flex; gap: 0.5rem; flex-shrink: 0; }
    .saved-sets-item .btn { padding: 0.45rem 0.9rem; font-size: 0.85rem; border-radius: 8px; }
    .saved-sets-item .btn[data-action="edit"] { color: var(--text-muted); border-color: rgba(255,255,255,0.15); }
    .saved-sets-item .btn[data-action="edit"]:hover { color: var(--accent); border-color: var(--accent); }
    .saved-sets-item .btn[data-action="delete"] { color: var(--text-muted); border-color: var(--border-strong); }
    .saved-sets-item .btn[data-action="delete"]:hover { color: #f87171; border-color: rgba(248,113,113,0.5); background: rgba(248,113,113,0.08); }
    .saved-sets-item .btn[data-action="export"] { color: var(--text-muted); border-color: var(--border-strong); }
    .saved-sets-item .btn[data-action="export"]:hover { color: var(--accent); border-color: var(--accent); }
    body.theme-light .saved-sets-item .btn[data-action="edit"] { border-color: rgba(0,0,0,0.15); }
    body.theme-light .saved-sets-item .btn[data-action="delete"] { border-color: var(--border-strong); }
    body.theme-light .saved-sets-item .btn[data-action="export"] { border-color: var(--border-strong); }
    .saved-sets-empty { font-size: 0.9rem; color: var(--text-muted); padding: 1rem 0; text-align: center; }
    .import-name-wrap { margin-top: 0.75rem; }
    .import-name-wrap label { display: block; font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.35rem; }
    .import-name-wrap input { width: 100%; max-width: 320px; padding: 0.5rem 0.75rem; font-size: 0.9rem; background: var(--bg); border: 1px solid rgba(255,255,255,0.12); border-radius: 8px; color: var(--text); }
    .import-folder-label { display: block; font-size: 0.85rem; color: var(--text-muted); margin-top: 0.5rem; margin-bottom: 0.35rem; }
    .import-name-wrap select { max-width: 280px; padding: 0.5rem 0.75rem; font-size: 0.9rem; background: var(--bg); border: 1px solid rgba(255,255,255,0.12); border-radius: 8px; color: var(--text); }
    body.theme-light .import-name-wrap input { background: var(--bg); border-color: rgba(0,0,0,0.12); }
    body.theme-light .import-name-wrap select { background: var(--bg); border-color: rgba(0,0,0,0.12); }
    .import-review-wrap { margin-top: 0.75rem; }
    .import-review-wrap label { display: block; font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.35rem; }
    .import-review-wrap textarea { width: 100%; max-width: 100%; padding: 0.5rem 0.75rem; font-size: 0.85rem; font-family: inherit; background: var(--bg); border: 1px solid rgba(255,255,255,0.12); border-radius: 8px; color: var(--text); resize: vertical; min-height: 4rem; }
    body.theme-light .import-review-wrap textarea { background: var(--bg); border-color: rgba(0,0,0,0.12); }
    .storage-desc { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 1rem; line-height: 1.5; }
    .storage-desc code { font-size: 0.75em; padding: 0.15em 0.4em; background: var(--bg); border-radius: 4px; }
    .btn-one-save {
      width: 100%;
      margin-bottom: 1rem;
      min-height: 48px;
      font-size: 1rem;
    }
    .storage-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 0.75rem;
    }
    @media (max-width: 420px) {
      .storage-grid { grid-template-columns: 1fr; }
    }
    .storage-card {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      text-align: left;
      padding: 1.1rem 1.2rem;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-subtle);
      background: var(--surface);
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }
    body.theme-light .storage-card { border-color: var(--border-subtle-hover); background: var(--card); }
    .storage-card:hover {
      border-color: var(--accent);
      background: var(--accent-soft);
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }
    body.theme-light .storage-card:hover { background: var(--surface); border-color: var(--accent); }
    .storage-card .title { font-weight: 600; font-size: 0.9rem; color: var(--text); }
    .storage-card .hint { font-size: 0.75rem; color: var(--text-muted); margin-top: 0.35rem; line-height: 1.4; }
    .save-success-tip {
      margin-top: 1rem;
      padding: 1rem;
      background: var(--surface);
      border: 1px solid rgba(139, 92, 246, 0.3);
      border-radius: var(--radius-sm);
    }
    body.theme-light .save-success-tip { border-color: rgba(124, 58, 237, 0.35); background: var(--card); }
    .save-success-tip-title { font-weight: 600; font-size: 0.9rem; margin-bottom: 0.35rem; }
    .save-success-tip-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.5rem; }
    .save-success-tip-cmd-wrap { display: flex; flex-wrap: wrap; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; }
    .save-success-tip-cmd {
      flex: 1;
      min-width: 0;
      font-size: 0.8rem;
      padding: 0.5rem 0.6rem;
      background: var(--bg);
      border-radius: 6px;
      word-break: break-all;
    }
    body.theme-light .save-success-tip-cmd { background: var(--surface); }
    .save-success-tip-extra { font-size: 0.8rem; color: var(--text-muted); }
    .storage-fallback { margin-top: 0.75rem; font-size: 0.8rem; color: var(--text-muted); }
    .storage-fallback a { color: var(--accent); text-decoration: none; }
    .storage-fallback a:hover { text-decoration: underline; }
    input[type="file"]#file-import-data { display: none; }

    /* Review materials modal */
    .review-modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }
    .review-modal-overlay.show { display: flex; }
    .review-modal {
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border-strong);
      padding: 1.5rem;
      max-width: 420px;
      width: 100%;
      max-height: 85vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: var(--shadow);
    }
    body.theme-light .review-modal { border-color: var(--border-strong); }
    .review-modal h3 { font-size: 1rem; margin-bottom: 1rem; color: var(--text); }
    .review-modal-body { flex: 1; overflow-y: auto; margin-bottom: 1rem; display: flex; flex-direction: column; gap: 1rem; }
    .review-modal-texts-wrap { max-height: 180px; overflow-y: auto; border-radius: var(--radius-sm); border: 1px solid var(--border-subtle); background: var(--surface); padding: 0.6rem 0.75rem; }
    body.theme-light .review-modal-texts-wrap { border-color: var(--border-subtle-hover); }
    .review-modal-texts { font-size: 0.9rem; line-height: 1.6; color: var(--text); white-space: pre-wrap; word-break: break-word; }
    .review-modal-texts .review-text-block { margin-bottom: 0.75rem; }
    .review-modal-texts .review-text-block:last-child { margin-bottom: 0; }
    .review-modal-links { display: flex; flex-direction: column; gap: 0.5rem; }
    .review-modal-links a {
      display: block;
      padding: 0.6rem 0.75rem;
      background: var(--surface);
      border-radius: var(--radius-sm);
      color: var(--accent);
      text-decoration: none;
      font-size: 0.9rem;
      word-break: break-all;
      border: 1px solid var(--border-subtle);
      transition: background 0.2s, border-color 0.2s;
    }
    .review-modal-links a:hover { background: var(--accent-soft); border-color: var(--accent); }
    body.theme-light .review-modal-links a { border-color: var(--border-subtle-hover); }
    .review-modal-links .review-modal-msg {
      display: block;
      padding: 0.6rem 0.75rem;
      background: var(--surface);
      border-radius: var(--radius-sm);
      font-size: 0.9rem;
      line-height: 1.5;
      word-break: break-word;
      white-space: pre-wrap;
      color: var(--text);
      border: 1px solid var(--border-subtle);
    }
    body.theme-light .review-modal-links .review-modal-msg { border-color: var(--border-subtle-hover); }
    .review-modal-actions { display: flex; gap: 0.75rem; flex-shrink: 0; }
    .review-modal-actions .btn { flex: 1; }

    /* Edit set modal */
    .edit-set-modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 1001;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }
    .edit-set-modal-overlay.show { display: flex; }
    .edit-set-modal {
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border-strong);
      padding: 1.5rem;
      max-width: 440px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow);
    }
    body.theme-light .edit-set-modal { border-color: var(--border-strong); }
    .edit-set-modal h3 { font-size: 1rem; margin-bottom: 1.25rem; color: var(--text); }
    .edit-set-field { margin-bottom: 1rem; }
    .edit-set-field label { display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.35rem; }
    .edit-set-field input,
    .edit-set-field select,
    .edit-set-field textarea {
      width: 100%;
      padding: 0.55rem 0.75rem;
      font-size: 0.9rem;
      font-family: inherit;
      background: var(--surface);
      border: 1px solid var(--border-strong);
      border-radius: var(--radius-sm);
      color: var(--text);
    }
    .edit-set-field textarea { resize: vertical; min-height: 4.5rem; }
    body.theme-light .edit-set-field input,
    body.theme-light .edit-set-field select,
    body.theme-light .edit-set-field textarea { background: var(--card); border-color: rgba(0,0,0,0.12); }
    .edit-set-meta { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 1rem; }
    .edit-set-append .btn { margin-top: 0.5rem; }
    .edit-set-review-label { display: block; font-size: 0.85rem; font-weight: 600; color: var(--text-muted); margin-bottom: 0.5rem; }
    .edit-set-review-row { margin-bottom: 0.75rem; }
    .edit-set-review-row label { display: block; font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.25rem; }
    .edit-set-review-row textarea { width: 100%; padding: 0.5rem 0.75rem; font-size: 0.85rem; font-family: inherit; background: var(--surface); border: 1px solid var(--border-strong); border-radius: var(--radius-sm); color: var(--text); resize: vertical; }
    body.theme-light .edit-set-review-row textarea { background: var(--card); border-color: rgba(0,0,0,0.12); }
    .edit-set-paste-images { margin-top: 0.5rem; }
    .edit-set-paste-images-hint { display: block; font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.35rem; }
    .edit-set-paste-zone {
      min-height: 56px;
      padding: 0.5rem 0.75rem;
      border: 2px dashed rgba(255,255,255,0.2);
      border-radius: var(--radius-sm);
      background: var(--surface);
      color: var(--text-muted);
      font-size: 0.85rem;
      cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
    }
    .edit-set-paste-zone:hover { border-color: var(--accent); background: var(--accent-soft); color: var(--text); }
    .edit-set-paste-zone:focus { outline: none; border-color: var(--accent); }
    body.theme-light .edit-set-paste-zone { border-color: rgba(0,0,0,0.15); background: var(--card); }
    .edit-set-pasted-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem; }
    .edit-set-pasted-item { position: relative; flex-shrink: 0; }
    .edit-set-pasted-item img { display: block; max-width: 80px; max-height: 80px; border-radius: 8px; border: 1px solid var(--border-strong); }
    .edit-set-pasted-item .edit-set-pasted-remove { position: absolute; top: 2px; right: 2px; width: 20px; height: 20px; border-radius: 50%; border: none; background: rgba(0,0,0,0.6); color: #fff; font-size: 14px; line-height: 1; cursor: pointer; padding: 0; display: flex; align-items: center; justify-content: center; }
    .review-modal-links .review-modal-img { max-width: 100%; max-height: 280px; display: block; border-radius: var(--radius-sm); margin-top: 0.25rem; }
    .review-modal-images { display: flex; flex-direction: column; gap: 0.5rem; }
    .review-modal-images .review-modal-msg { margin: 0; }
    .review-modal-images .review-modal-img { max-width: 100%; max-height: 240px; display: block; border-radius: var(--radius-sm); cursor: pointer; }
    .review-modal-images .review-modal-msg { cursor: pointer; }
    .image-lightbox-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 10000; display: flex; align-items: center; justify-content: center; padding: 2rem; box-sizing: border-box; opacity: 0; visibility: hidden; transition: opacity 0.2s, visibility 0.2s; }
    .image-lightbox-overlay.show { opacity: 1; visibility: visible; }
    .image-lightbox-overlay .image-lightbox-content { position: relative; max-width: 95vw; max-height: 95vh; display: flex; align-items: center; justify-content: center; }
    .image-lightbox-overlay .image-lightbox-content img { max-width: 95vw; max-height: 95vh; width: auto; height: auto; object-fit: contain; border-radius: var(--radius-sm); box-shadow: 0 8px 32px rgba(0,0,0,0.5); }
    .image-lightbox-overlay .image-lightbox-close { position: absolute; top: -2.5rem; right: 0; min-width: 44px; min-height: 44px; width: 2.5rem; height: 2.5rem; border: none; background: rgba(255,255,255,0.2); color: #fff; font-size: 1.25rem; line-height: 1; cursor: pointer; border-radius: 50%; display: flex; align-items: center; justify-content: center; padding: 0; }
    .image-lightbox-overlay .image-lightbox-close:hover { background: rgba(255,255,255,0.35); }
    .toast { position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%); padding: 0.65rem 1.25rem; background: var(--surface); border: 1px solid var(--border-strong); border-radius: 999px; color: var(--text); font-size: 0.9rem; z-index: 10001; box-shadow: 0 4px 20px rgba(0,0,0,0.3); opacity: 0; visibility: hidden; transition: opacity 0.35s, visibility 0.35s, transform 0.35s; pointer-events: none; }
    .toast.show { opacity: 1; visibility: visible; }
    body.theme-light .toast { border-color: var(--border-strong); box-shadow: 0 4px 20px rgba(0,0,0,0.12); }
    .edit-set-actions { display: flex; gap: 0.75rem; margin-bottom: 1rem; }
    .edit-set-actions .btn { flex: 1; }
    .edit-set-extra { padding-top: 0.75rem; border-top: 1px solid rgba(255,255,255,0.06); display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
    body.theme-light .edit-set-extra { border-top-color: rgba(0,0,0,0.08); }
    .edit-set-sep { color: var(--text-muted); opacity: 0.6; font-size: 0.85rem; }
    .preview-questions-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 9999; align-items: center; justify-content: center; padding: 1.5rem; box-sizing: border-box; }
    .preview-questions-overlay.show { display: flex; }
    .preview-questions-modal { width: 100%; max-width: 560px; max-height: 85vh; display: flex; flex-direction: column; background: var(--card); border-radius: var(--radius); border: 1px solid var(--border-subtle-hover); box-shadow: var(--shadow-lg); }
    body.theme-light .preview-questions-modal { border-color: rgba(0,0,0,0.1); }
    .preview-questions-modal h3 { font-size: 1rem; margin: 0 0 0.75rem 0; padding: 0 1rem; color: var(--text); flex-shrink: 0; }
    .preview-questions-body { flex: 1; overflow-y: auto; padding: 0 1rem 1rem; display: flex; flex-direction: column; gap: 1rem; min-height: 0; }
    .preview-questions-body .preview-q { padding: 0.85rem 1rem; background: var(--surface); border-radius: var(--radius-sm); border: 1px solid var(--border-subtle); font-size: 0.9rem; }
    body.theme-light .preview-questions-body .preview-q { border-color: rgba(0,0,0,0.08); }
    .preview-questions-body .preview-q-head { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.5rem; }
    .preview-questions-body .preview-q-stem { color: var(--text); line-height: 1.55; margin-bottom: 0.5rem; }
    .preview-questions-body .preview-q-options { margin: 0.35rem 0; padding-left: 1rem; color: var(--text); }
    .preview-questions-body .preview-q-correct { font-size: 0.85rem; color: var(--correct); margin-top: 0.4rem; }
    .preview-questions-body .preview-q-explanation { font-size: 0.85rem; color: var(--text-muted); margin-top: 0.35rem; }
    .preview-questions-actions { padding: 0 1rem 1rem; flex-shrink: 0; }
    .btn-link { background: none; border: none; color: var(--accent); font-size: 0.85rem; cursor: pointer; padding: 0.35rem 0; text-decoration: underline; }
    .btn-link:hover { color: var(--accent-hover); }
    .btn-link-danger { background: none; border: none; color: var(--text-muted); font-size: 0.85rem; cursor: pointer; padding: 0.35rem 0; text-decoration: underline; }
    .btn-link-danger:hover { color: #f87171; }

    /* Screen reader only */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
    .skip-link {
      position: absolute;
      top: -100%;
      left: 0.75rem;
      z-index: 10002;
      padding: 0.75rem 1rem;
      background: var(--accent);
      color: #fff;
      font-weight: 600;
      border-radius: var(--radius-sm);
      text-decoration: none;
      transition: top 0.2s;
    }
    .skip-link:focus {
      top: 0.75rem;
      outline: 2px solid #fff;
      outline-offset: 2px;
    }
    .screen { contain: layout style; }

    @media print {
      .skip-link, #toast, .review-modal-overlay, .image-lightbox-overlay, .edit-set-modal-overlay, .preview-questions-overlay,
      header .theme-toggle, header .home-actions .btn,
      .result-actions, .result-shortcut-hint, .result-recent { display: none !important; }
      body { background: #fff; color: #111; }
      .container, .screen.active, .result-card, .question-card { background: #fff; color: #111; border-color: #ddd; box-shadow: none; }
      .screen { display: none !important; }
      .screen.active { display: block !important; }
      a { color: #111; }
    }
  </style>
</head>
<body>
  <a href="#main" class="skip-link">Ë∑≥ËøáËá≥‰∏ªÂÜÖÂÆπ</a>
  <div class="container" id="main" role="main">
    <header>
      <div class="brand">
        <h1>Fran√ßais Quiz</h1>
        <p>TCF Â°´Á©∫ ¬∑ ÊÆµËêΩÂ°´Á©∫ ¬∑ ÂçïÈÄâ ¬∑ Â§öÈÄâ</p>
      </div>
      <button type="button" class="theme-toggle" id="theme-toggle" title="ÂàáÊç¢Ê∑±Ëâ≤/ÊµÖËâ≤" aria-label="ÂàáÊç¢Ê∑±Ëâ≤ÊàñÊµÖËâ≤‰∏ªÈ¢ò" aria-pressed="false">üåì</button>
    </header>

    <div id="screen-home" class="screen active">
      <div class="stats-bar" id="stats-bar">
        <span>‰ªäÊó•Â∑≤ÁªÉ <strong id="stat-today">0</strong> È¢ò</span>
        <span>ËøûÁª≠ <strong id="stat-streak">0</strong> Â§©</span>
        <span>ÈîôÈ¢òÊú¨ <strong id="stat-wrong">0</strong> È¢ò</span>
        <span>‰π†È¢òÈõÜ <strong id="stat-sets">0</strong> Â•ó</span>
      </div>

      <div class="home-section">
        <h2>ÂºÄÂßãÁªÉ‰π†</h2>
        <div class="timer-wrap">
          <label for="timer-seconds">ÊØèÈ¢òÂÄíËÆ°Êó∂ÔºàÁßíÔºâ</label>
          <input type="number" id="timer-seconds" min="0" max="120" value="10" title="0 Ë°®Á§∫‰∏çÈôêÊó∂" />
          <div class="shuffle-wrap">
            <input type="checkbox" id="shuffle-questions" />
            <label for="shuffle-questions">Êâì‰π±È¢òÁõÆÈ°∫Â∫è</label>
          </div>
          <div class="shuffle-wrap">
            <input type="checkbox" id="shuffle-options" />
            <label for="shuffle-options">Êâì‰π±ÈÄâÈ°πÈ°∫Â∫è</label>
          </div>
        </div>
        <div class="type-filter-wrap">
          <span class="type-filter-label">Âè™ÂÅö‰ª•‰∏ãÈ¢òÂûãÔºà‰∏çÂãæÈÄâ = ÂÖ®ÈÉ®Ôºâ</span>
          <div class="type-filter-row">
            <label><input type="checkbox" id="filter-type-single" checked /> ÂçïÈÄâ</label>
            <label><input type="checkbox" id="filter-type-multiple" checked /> Â§öÈÄâ</label>
            <label><input type="checkbox" id="filter-type-fill" checked /> Â°´Á©∫</label>
            <label><input type="checkbox" id="filter-type-paragraph" checked /> ÊÆµËêΩÂ°´Á©∫</label>
          </div>
        </div>
        <div class="start-select-wrap">
          <label for="start-practice-select">ÈÄâÊã©‰π†È¢òÈõÜ</label>
          <select id="start-practice-select">
            <option value="default">ÈªòËÆ§È¢òÁõÆ</option>
          </select>
        </div>
        <div class="category-filter-wrap" id="category-filter-wrap">
          <label for="filter-category">ÂàÜÁ±ªÁ≠õÈÄâ</label>
          <select id="filter-category">
            <option value="">ÂÖ®ÈÉ®</option>
          </select>
        </div>
        <div class="home-actions">
          <button type="button" class="btn btn-primary" id="btn-start-practice">ÂºÄÂßãÁªÉ‰π†</button>
          <button type="button" class="btn btn-secondary" id="btn-import-show">ÂØºÂÖ•ÊàëÁöÑÈ¢òÁõÆ</button>
        </div>
        <div class="import-section" id="import-section" style="display: none;">
        <h3>Á≤òË¥¥È¢òÁõÆÊñáÊú¨ÔºàÊîØÊåÅ‰Ω†ÁªôÁöÑÊ†ºÂºèÔºâ</h3>
        <textarea id="import-text" placeholder="Á≤òË¥¥È¢òÁõÆÊñáÊú¨ÔºàËßÅ‰∏ãÊñπËØ¥ÊòéÔºâÊàñ JSON Êï∞ÁªÑ‚Ä¶"></textarea>
        <div class="import-name-wrap">
          <label for="import-set-name">‰π†È¢òÈõÜÂêçÁß∞Ôºà‰øùÂ≠òÁî®ÔºåÂ°´ÂÜôÂêéÊú¨Ê¨°ÂØºÂÖ•‰ºöÂä†ÂÖ•„ÄåÊàëÁöÑ‰π†È¢òÈõÜ„ÄçÔºâ</label>
          <input type="text" id="import-set-name" placeholder="‰æãÂ¶ÇÔºöavoir Âõ∫ÂÆöË°®Ëææ" autocomplete="off" />
          <label for="import-set-folder" class="import-folder-label">‰øùÂ≠òÂà∞Êñá‰ª∂Â§π</label>
          <select id="import-set-folder">
            <option value="">Êú™ÂàÜÁ±ª</option>
          </select>
        </div>
        <div class="import-review-wrap">
          <label for="import-review-urls">ÁªÉ‰π†ÂâçÂ§ç‰π†ËµÑÊñôÔºàÂèØÈÄâÔºåÊØèË°å‰∏Ä‰∏™ URLÔºåÂºÄÂßãÁªÉ‰π†ÂâçÂèØÂÖàÁúãÔºâ</label>
          <textarea id="import-review-urls" rows="3" placeholder="https://‚Ä¶&#10;https://‚Ä¶" autocomplete="off"></textarea>
        </div>
        <button type="button" class="btn btn-primary" id="btn-import-parse" style="margin-top: 0.75rem;">Ëß£ÊûêÂπ∂ÂºÄÂßã</button>
        </div>
      </div>

      <div class="home-section">
        <h2>ÈîôÈ¢òÊú¨</h2>
        <div class="home-actions">
          <button type="button" class="btn wrong-book-btn" id="btn-wrong-book">ÊåâËÆ°ÂàíÂ§ç‰π† (<span id="wrong-count">0</span>)</button>
          <button type="button" class="btn btn-secondary" id="btn-wrong-free">Ëá™Áî±ÁªÉ‰π†ÂÖ®ÈÉ®</button>
          <button type="button" class="btn btn-secondary" id="btn-clear-wrong">Ê∏ÖÁ©∫ÈîôÈ¢òÊú¨</button>
        </div>
      </div>

      <div class="home-section saved-sets" id="saved-sets-section">
        <h2>ÊàëÁöÑ‰π†È¢òÈõÜ</h2>
        <div class="saved-sets-search">
          <div class="saved-sets-search-wrap">
            <input type="text" id="saved-sets-search" placeholder="ÊêúÁ¥¢‰π†È¢òÈõÜÂêçÁß∞‚Ä¶" autocomplete="off" />
          </div>
        </div>
        <div class="saved-sets-folders-bar" id="saved-sets-folders-bar">
          <span class="saved-sets-folders-label">Êñá‰ª∂Â§π</span>
          <button type="button" class="btn btn-secondary btn-sm" id="btn-add-folder">Ê∑ªÂä†Êñá‰ª∂Â§π</button>
          <div class="saved-sets-folder-tags" id="saved-sets-folder-tags"></div>
        </div>
        <div class="saved-sets-list-wrap">
          <div id="saved-sets-list"></div>
          <p class="saved-sets-empty" id="saved-sets-empty" style="display: none;">ÊöÇÊó†‰øùÂ≠òÁöÑ‰π†È¢òÈõÜÔºåÂØºÂÖ•È¢òÁõÆÊó∂Â°´ÂÜôÂêçÁß∞Âç≥ÂèØ‰øùÂ≠ò„ÄÇ</p>
        </div>
      </div>

      <div class="home-section" id="storage-section">
        <h2>Êï∞ÊçÆÂ≠òÂà∞È°πÁõÆÊñá‰ª∂Â§π / ‰∫ëÁ´ØÂêåÊ≠•</h2>
        <p class="storage-desc">ÁîµËÑëÔºö‰∏ÄÈîÆ‰øùÂ≠òÂà∞È°πÁõÆÈáåÁöÑ <code>french_quiz_data.json</code>„ÄÇÊâãÊú∫Ë¶ÅÁúãÂà∞Âêå‰∏Ä‰ªΩ‰π†È¢òÈõÜÔºö‰øùÂ≠òÂêéÂú®È°πÁõÆÁõÆÂΩïÊâßË°å‰∏ãÊñπÂëΩ‰ª§Ôºå<strong>ÂêåÊó∂Êé®ÈÄÅ‰∏ª‰ªìÂ∫ì + Pages Á´ôÁÇπ</strong>ÔºåÊâãÊú∫ÊâìÂºÄÊú¨È°µÂêéÁÇπ„Äå<strong>‰ªé‰∫ëÁ´ØÂä†ËΩΩ</strong>„ÄçÂç≥ÂèØÂêåÊ≠•„ÄÇ</p>
        <button type="button" class="btn btn-primary btn-one-save" id="btn-one-save">‰∏ÄÈîÆ‰øùÂ≠òÔºàË¶ÜÁõñÂà∞È°πÁõÆÊñá‰ª∂Â§πÔºâ</button>
        <button type="button" class="btn btn-primary btn-one-save" id="btn-load-cloud" style="background: linear-gradient(135deg, #059669, #0d9488);">‰ªé‰∫ëÁ´ØÂä†ËΩΩÔºàÊâãÊú∫ÂêåÊ≠•‰π†È¢òÈõÜÔºâ</button>
        <div class="storage-grid">
          <button type="button" class="storage-card" id="btn-open-folder">
            <span class="title">ÊâìÂºÄÂπ∂Âä†ËΩΩ</span>
            <span class="hint">ÈÄâÊã© french-quiz Êñá‰ª∂Â§πÔºåËØªÂèñÊú¨Âú∞ JSON</span>
          </button>
          <button type="button" class="storage-card" id="btn-save-to-folder">
            <span class="title">‰øùÂ≠òÂà∞È°πÁõÆÊñá‰ª∂Â§π</span>
            <span class="hint">Ë¶ÜÁõñ french_quiz_data.json</span>
          </button>
          <button type="button" class="storage-card" id="btn-export-data">
            <span class="title">ÂØºÂá∫Âà∞È°πÁõÆÊñá‰ª∂Â§πÔºàË¶ÜÁõñÔºâ</span>
            <span class="hint">Áõ¥Êé•ÂÜôÂÖ•È°πÁõÆÁõÆÂΩïÔºåË¶ÜÁõñÂéüÊñá‰ª∂</span>
          </button>
          <button type="button" class="storage-card" id="btn-import-data">
            <span class="title">‰ªéÊñá‰ª∂ÂØºÂÖ•</span>
            <span class="hint">ÈÄâÊã©Êú¨Êú∫ JSON Êñá‰ª∂ÊÅ¢Â§çÊï∞ÊçÆ</span>
          </button>
        </div>
        <div class="save-success-tip" id="save-success-tip" style="display: none;">
          <p class="save-success-tip-title">Â∑≤‰øùÂ≠ò„ÄÇË¶ÅÂêåÊ≠•Âà∞ GitHubÔºà‰∏ª‰ªìÂ∫ì + Pages Á´ôÁÇπ‰∏ÄËµ∑Êõ¥Êñ∞ÔºâÔºö</p>
          <p class="save-success-tip-desc">Âú®È°πÁõÆÁõÆÂΩïÊâìÂºÄÁªàÁ´ØÔºåËøêË°åÔºàÊàñÁÇπÂáªÂ§çÂà∂ÔºâÔºåÊää <code>../french-quiz-pages</code> Êç¢Êàê‰Ω†ÁöÑÂÖ¨ÂºÄ Pages ‰ªìÂ∫ìË∑ØÂæÑÔºö</p>
          <div class="save-success-tip-cmd-wrap">
            <code class="save-success-tip-cmd" id="save-deploy-cmd">./scripts/sync-and-push.sh ../french-quiz-pages</code>
            <button type="button" class="btn btn-secondary btn-sm" id="btn-copy-deploy-cmd">Â§çÂà∂ÂëΩ‰ª§</button>
          </div>
          <p class="save-success-tip-extra">Âè™Êé®ÂΩìÂâç‰ªìÂ∫ìÁî® <code>./scripts/sync-and-push.sh</code>ÔºõÂêåÊó∂Êõ¥Êñ∞‰∏ª‰ªìÂ∫ì+Pages Áî® <code>./scripts/sync-and-push.sh ../french-quiz-pages</code>„ÄÇÈ¶ñÊ¨°ÈúÄ <code>chmod +x scripts/sync-and-push.sh</code>„ÄÇ</p>
        </div>
        <p class="storage-fallback">Êó†Ê≥ïÈÄâÊã©Êñá‰ª∂Â§πÔºü<a href="#" id="link-download-json">‰∏ãËΩΩ JSON Âà∞ÁîµËÑë</a></p>
        <input type="file" id="file-import-data" accept=".json,application/json" />
      </div>

      <div class="home-section format-doc" id="format-doc">
        <h2 class="format-doc-title">ÂêÑÈ¢òÂûãÊ†ºÂºèËØ¥ÊòéÔºàÁÇπÂºÄÊü•ÁúãÔºâ</h2>
        <div class="format-doc-content">
          <p><strong>ÈÄöÁî®Ôºö</strong>ÂèØÁõ¥Êé•Á≤òË¥¥ JSON È¢òÁõÆÊï∞ÁªÑÔºåÊàñÊåâ‰∏ãÊñπÊñáÊú¨Ê†ºÂºèÁ≤òË¥¥„ÄÇ</p>
          <p><span class="type-tag">ÂçïÈÄâÈ¢ò single_choice</span></p>
          <pre>{"type":"single_choice","stem":"Nous ______ une lettre.","options":["√©cris","√©crit","√©crivons","√©crivent"],"correct":2,"explanation":"nous Áî® √©crivons„ÄÇ","category":"ËØ≠Ê≥ï"}</pre>
          <p><span class="type-tag">Â§öÈÄâÈ¢ò multiple_choice</span> ‚Äî correct ‰∏∫Ê≠£Á°ÆÈÄâÈ°πÁ¥¢ÂºïÊï∞ÁªÑ„ÄÇ</p>
          <pre>{"type":"multiple_choice","stem":"‰∏ãÂàóÂì™‰∫õÊòØÂ§çÊï∞ÂΩ¢ÂºèÔºü","options":["ils","il","elles","elle"],"correct":[0,2],"explanation":"ils/elles ‰∏∫Â§çÊï∞„ÄÇ"}</pre>
          <p><span class="type-tag">Â°´Á©∫È¢ò fill_blank</span> ‚Äî correct ‰∏∫Á≠îÊ°àÂ≠óÁ¨¶‰∏≤ÊàñÂèØÊé•ÂèóÁ≠îÊ°àÊï∞ÁªÑ„ÄÇ</p>
          <pre>{"type":"fill_blank","stem":"Il _____ (avoir) 20 ans.","correct":["a","a "],"explanation":"avoir Á¨¨‰∏â‰∫∫Áß∞ÂçïÊï∞Âèò‰Ωç‰∏∫ a„ÄÇ"}</pre>
          <p><span class="type-tag">ÊÆµËêΩÂ°´Á©∫È¢ò paragraph_fill_blank</span> ‚Äî È¢òÂπ≤‰∏≠Áî® _____ Ë°®Á§∫Á©∫ÔºåÈ°∫Â∫èÂØπÂ∫î correct Êï∞ÁªÑ„ÄÇ</p>
          <pre>{"type":"paragraph_fill_blank","stem":"Il a _____ ans. Elle _____ (s'appeler) Marie.","correct":["15","s'appelle"],"explanation":"‰∏§Á©∫‰æùÊ¨°Â°´ÂÜô„ÄÇ"}</pre>
          <p><strong>ÊñáÊú¨Ê†ºÂºèÔºàÂçïÈÄâÈ¢òÔºâÔºö</strong>Âê´„ÄåÈ¢òÂûãÔºö„Äç„ÄåA) B) C) D)„Äç„ÄåÊ≠£Á°ÆÔºö„ÄçÂç≥ÂèØËß£Êûê„ÄÇ‰æãÔºö</p>
          <pre>È¢òÂûãÔºöNous ______ une lettre √† nos parents.
A) √©cris  B) √©crit  C) √©crivons  D) √©crivent
Ê≠£Á°ÆÔºöC</pre>
        </div>
      </div>
    </div>

    <div id="screen-quiz" class="screen">
      <div class="progress-wrap">
        <span class="progress-estimate" id="progress-estimate"></span>
        <span class="progress-label" id="progress-label">Á¨¨ 1 / 1 È¢ò</span>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
        </div>
      </div>
      <div class="question-card" role="region" aria-labelledby="question-stem" aria-describedby="question-meta">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:0.5rem;">
          <div class="question-meta" id="question-meta"></div>
          <div style="display:flex;align-items:center;gap:0.35rem;">
            <svg class="timer-ring" id="timer-ring" width="40" height="40" viewBox="0 0 40 40" style="display:none;">
              <circle cx="20" cy="20" r="17" fill="none" stroke="var(--surface)" stroke-width="3" />
              <circle class="timer-ring-fill" id="timer-ring-fill" cx="20" cy="20" r="17" fill="none" stroke="var(--accent)" stroke-width="3" stroke-dasharray="106.81" stroke-dashoffset="0" stroke-linecap="round" transform="rotate(-90 20 20)" />
            </svg>
            <span class="quiz-timer" id="quiz-timer" style="display: none;"></span>
          </div>
        </div>
        <div class="question-stem-wrap">
          <div class="question-stem" id="question-stem"></div>
          <button type="button" class="btn-read-aloud" id="btn-read-aloud" title="ÊúóËØªÈ¢òÂπ≤ÔºàÊ≥ïËØ≠Ôºâ" aria-label="ÊúóËØªÈ¢òÂπ≤ÔºàÊ≥ïËØ≠Ôºâ">üîä ÊúóËØª</button>
        </div>
        <div class="options" id="options-container"></div>
        <div class="fill-input-wrap" id="fill-input-wrap" style="display: none;">
          <input type="text" id="fill-input" placeholder="ËæìÂÖ•Á≠îÊ°à..." autocomplete="off" />
        </div>
        <div class="paragraph-blanks" id="paragraph-blanks-wrap" style="display: none;"></div>
        <div class="answer-feedback" id="answer-feedback"></div>
        <div class="explanation" id="explanation" style="display: none;"></div>
        <div class="wrong-book-remove-wrap" id="wrong-book-remove-wrap" style="display: none;">
          <button type="button" class="btn btn-secondary btn-sm" id="btn-remove-from-wrong">ÁßªÂá∫ÈîôÈ¢òÊú¨</button>
        </div>
        <div class="remove-from-set-wrap" id="remove-from-set-wrap" style="display: none;">
          <button type="button" class="btn btn-secondary btn-sm" id="btn-remove-from-set">‰ªéÁªÉ‰π†ÈõÜÂà†Èô§Êú¨È¢ò</button>
        </div>
      </div>
      <div class="quiz-actions">
        <span id="question-counter"></span>
        <div class="quiz-actions-right">
          <button type="button" class="btn btn-secondary" id="btn-exit-quiz" aria-label="ÊèêÂâçÈÄÄÂá∫ÁªÉ‰π†">ÊèêÂâçÈÄÄÂá∫</button>
          <button type="button" class="btn btn-primary" id="btn-next" style="display: none;" aria-label="‰∏ã‰∏ÄÈ¢ò" aria-keyshortcuts="Enter">‰∏ã‰∏ÄÈ¢ò</button>
          <button type="button" class="btn btn-primary" id="btn-submit" aria-label="Á°ÆËÆ§Á≠îÊ°à" aria-keyshortcuts="Enter">Á°ÆËÆ§</button>
        </div>
      </div>
      <p class="quiz-shortcut-hint" aria-hidden="true">Âø´Êç∑ÈîÆÔºö1‚Äì4 ÈÄâÈÄâÈ°πÔºåEnter Á°ÆËÆ§</p>
    </div>

    <div id="screen-result" class="screen">
      <div class="result-card" id="result-card" aria-live="polite" aria-atomic="true">
        <div class="result-score" id="result-score" role="text">0/0</div>
        <p class="result-pct" id="result-pct"></p>
        <p class="result-desc" id="result-desc">ÂÆåÊàêÁªÉ‰π†</p>
        <p class="result-celebration" id="result-celebration" style="display: none;">üéâ ÂÖ®ÂØπÔºÅ</p>
        <div class="result-confetti" id="result-confetti" aria-hidden="true"></div>
        <div class="result-actions">
          <button type="button" class="btn btn-primary" id="btn-restart" aria-label="ÂÜçÁªÉ‰∏ÄÈÅç">ÂÜçÁªÉ‰∏ÄÈÅç</button>
          <button type="button" class="btn wrong-book-btn" id="btn-result-wrong" aria-label="ÈîôÈ¢òÊú¨ÊåâËÆ°ÂàíÂ§ç‰π†">ÈîôÈ¢òÊú¨¬∑ÊåâËÆ°Âàí</button>
          <button type="button" class="btn btn-secondary" id="btn-result-wrong-free" aria-label="ÈîôÈ¢òËá™Áî±ÁªÉ‰π†">ÈîôÈ¢òËá™Áî±ÁªÉ‰π†</button>
          <button type="button" class="btn btn-secondary" id="btn-share-result" aria-label="ÂàÜ‰∫´ÊàêÁª©">ÂàÜ‰∫´ÊàêÁª©</button>
          <button type="button" class="btn btn-secondary" id="btn-back-home" aria-label="ËøîÂõûÈ¶ñÈ°µ">ËøîÂõûÈ¶ñÈ°µ</button>
        </div>
        <p class="result-shortcut-hint" aria-hidden="true">ÊèêÁ§∫ÔºöÁ≠îÈ¢òÊó∂Êåâ Enter ÂèØ‰∏ã‰∏ÄÈ¢òÔºåEsc ÂÖ≥Èó≠ÂºπÁ™ó</p>
        <div class="result-recent" id="result-recent" style="display: none;"></div>
      </div>
    </div>
    <div id="sr-announcer" class="sr-only" aria-live="assertive" aria-atomic="true"></div>
  </div>

  <div class="review-modal-overlay" id="review-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="review-modal-title">
    <div class="review-modal">
      <h3 id="review-modal-title">ÊòØÂê¶ËßÇÁúãÂ§ç‰π†ÊùêÊñôÔºü</h3>
      <div class="review-modal-body">
        <div class="review-modal-texts-wrap" id="review-modal-texts-wrap">
          <div class="review-modal-texts roll" id="review-modal-texts"></div>
        </div>
        <div class="review-modal-links" id="review-modal-links"></div>
        <div class="review-modal-images" id="review-modal-images"></div>
      </div>
      <div class="review-modal-actions">
        <button type="button" class="btn btn-primary" id="btn-review-start-quiz">Áõ¥Êé•ÂºÄÂßãÁªÉ‰π†</button>
      </div>
    </div>
  </div>

  <div class="image-lightbox-overlay" id="image-lightbox-overlay" role="dialog" aria-modal="true" aria-label="ÊîæÂ§ßÊü•ÁúãÂõæÁâá">
    <div class="image-lightbox-content">
      <img id="image-lightbox-img" src="" alt="ÊîæÂ§ßÂõæ" />
      <button type="button" class="image-lightbox-close" id="image-lightbox-close" aria-label="ÂÖ≥Èó≠" aria-keyshortcuts="Escape">√ó</button>
    </div>
  </div>

  <div id="toast" class="toast" aria-live="polite" role="status"></div>

  <div class="edit-set-modal-overlay" id="edit-set-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="edit-set-modal-title">
    <div class="edit-set-modal">
      <h3 id="edit-set-modal-title">ÁºñËæë‰π†È¢òÈõÜ</h3>
      <div class="edit-set-field">
        <label for="edit-set-name">‰π†È¢òÈõÜÂêçÁß∞</label>
        <input type="text" id="edit-set-name" placeholder="‰æãÂ¶ÇÔºöavoir Âõ∫ÂÆöË°®Ëææ" autocomplete="off" />
      </div>
      <div class="edit-set-field">
        <label for="edit-set-folder">ÊâÄÂ±ûÊñá‰ª∂Â§π</label>
        <select id="edit-set-folder">
          <option value="">Êú™ÂàÜÁ±ª</option>
        </select>
      </div>
      <div class="edit-set-field">
        <span class="edit-set-review-label">ÁªÉ‰π†ÂâçÂ§ç‰π†ËµÑÊñôÔºàÂèØÈÄâÔºâ</span>
        <div class="edit-set-review-row">
          <label for="edit-set-review-texts">ÊñáÊú¨ÔºàÊØèË°å‰∏ÄÊÆµÔºåÁªÉ‰π†ÂâçÂèØÊªöÂä®Êü•ÁúãÔºâ</label>
          <textarea id="edit-set-review-texts" rows="3" placeholder="Âè£ËØÄ„ÄÅËØ¥ÊòéÁ≠â&#10;ÊØèË°å‰∏ÄÊÆµ" autocomplete="off"></textarea>
        </div>
        <div class="edit-set-review-row">
          <label for="edit-set-review-links">ÈìæÊé•ÔºàÊØèË°å‰∏Ä‰∏™ URLÔºâ</label>
          <textarea id="edit-set-review-links" rows="2" placeholder="https://‚Ä¶" autocomplete="off"></textarea>
        </div>
        <div class="edit-set-paste-images" id="edit-set-paste-images">
          <span class="edit-set-paste-images-hint">ÂõæÁâáÔºöÁÇπÂáª‰∏ãÊñπÂå∫ÂüüÂêé Ctrl+V / Cmd+V Á≤òË¥¥</span>
          <div class="edit-set-paste-zone" id="edit-set-paste-zone" tabindex="0">Á≤òË¥¥ÂõæÁâáÂà∞Ê≠§Â§Ñ</div>
          <div class="edit-set-pasted-list" id="edit-set-pasted-list"></div>
        </div>
      </div>
      <div class="edit-set-meta" id="edit-set-meta"></div>
      <div class="edit-set-field edit-set-append">
        <label for="edit-set-append-text">ËøΩÂä†È¢òÁõÆÔºàÁ≤òË¥¥ JSON Êï∞ÁªÑÊàñÊñáÊú¨Ê†ºÂºèÔºå‰ºöËøΩÂä†Âà∞Êú¨È¢òÈõÜÊú´Â∞æÔºâ</label>
        <textarea id="edit-set-append-text" rows="4" placeholder="[{&quot;type&quot;:&quot;single_choice&quot;, ...}, ...] Êàñ È¢òÂûãÔºö... A) B) C) D) Ê≠£Á°ÆÔºöC" autocomplete="off"></textarea>
        <button type="button" class="btn btn-secondary btn-sm" id="btn-edit-set-append">Ëß£ÊûêÂπ∂ËøΩÂä†</button>
      </div>
      <div class="edit-set-actions">
        <button type="button" class="btn btn-primary" id="btn-edit-set-save">‰øùÂ≠ò</button>
        <button type="button" class="btn btn-secondary" id="btn-edit-set-cancel" aria-keyshortcuts="Escape">ÂèñÊ∂à</button>
      </div>
      <div class="edit-set-extra">
        <button type="button" class="btn btn-link" id="btn-edit-set-export">ÂØºÂá∫Êú¨È¢òÈõÜ (JSON)</button>
        <span class="edit-set-sep">¬∑</span>
        <button type="button" class="btn btn-link" id="btn-edit-set-preview" aria-haspopup="dialog">È¢ÑËßà‰π†È¢ò</button>
        <span class="edit-set-sep">¬∑</span>
        <button type="button" class="btn btn-link-danger" id="btn-edit-set-delete">Âà†Èô§Êú¨‰π†È¢òÈõÜ</button>
      </div>
    </div>
  </div>

  <div class="preview-questions-overlay" id="preview-questions-overlay" role="dialog" aria-modal="true" aria-labelledby="preview-questions-title">
    <div class="preview-questions-modal">
      <h3 id="preview-questions-title">‰π†È¢òÈ¢ÑËßà</h3>
      <div class="preview-questions-body" id="preview-questions-body"></div>
      <div class="preview-questions-actions">
        <button type="button" class="btn btn-primary" id="btn-preview-questions-close" aria-keyshortcuts="Escape">ÂÖ≥Èó≠</button>
      </div>
    </div>
  </div>

  <script src="app.js" defer></script>
</body>
</html>
